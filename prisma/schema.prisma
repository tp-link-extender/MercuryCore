// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Sections are commented out, not yet implemented

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// Users & Groups

model User {
    id              String    @id @unique @default(cuid())
    provider_id     String    @unique
    hashed_password String?
    session         Session[]

    username               String   @unique
    displayname            String?
    bio                    String?
    image                  String?
    created                DateTime @default(now())
    lastOnline             DateTime @default(now())
    Status                 String?
    currency               Int      @default(0)
    
    friends                User[]   @relation("friends")
    friendsRelation        User[]   @relation("friends")
    incomingRequests         User[]   @relation("incomingRequests")
    incomingRequestsRelation User[]   @relation("incomingRequests")
    outgoingRequests         User[]   @relation("outgoingRequests")
    outgoingRequestsRelation User[]   @relation("outgoingRequests")
    followers                User[]   @relation("followers")
    followersRelation        User[]   @relation("followers")
    following                User[]   @relation("following")
    followingRelation        User[]   @relation("following")
    // groupsOwned  Group[] @relation("owner")
    // groupsJoined Group[] @relation("member")
    places                 Place[]
    // posts       Post[]

    @@map("user")
}

model Session {
    id           String @id @unique
    user_id      String
    expires      BigInt
    idle_expires BigInt
    user         User   @relation(references: [id], fields: [user_id], onDelete: Cascade)

    @@index([user_id])
    @@map("session")
}

// model Group {
//     name          String        @unique
//     owner         User          @relation(name: "owner", fields: [ownerUsername], references: [username])
//     ownerUsername String
//     members       User[] @relation("member")
//     places        GroupPlace[]
// 	posts         GroupPost[]

//     @@id([name])
// }

// Places

model Place {
    name          String
    owner         User   @relation(fields: [ownerUsername], references: [username])
    ownerUsername String
    description   String
    image         String

    created DateTime @default(now())
    updated DateTime @default(now())

    @@id([name, ownerUsername])
}

// model GroupPlace {
//     name        String
//     owner       Group  @relation(fields: [groupName], references: [name])
//     description String
//     groupName   String

//     created DateTime @default(now())
//     updated DateTime @default(now())

//     @@id([name, groupName])
// }

// Posts

// model Post {
//     id           Int      @id @default(autoincrement())
//     Poster       User     @relation(fields: [userUsername], references: [username])
//     userUsername String
//     posted       DateTime @default(now())
// }
// model GroupPost {
//     id           Int      @id @default(autoincrement())
//     Poster       Group     @relation(fields: [groupName], references: [name])
//     groupName String
//     posted       DateTime @default(now())
// }
