<script lang="ts">
	export let data
</script>

<Head title="Forum" />

<div class="ctnr light-text max-w-280 flex flex-col gap-4">
	<h1 class="pb-6">Forum</h1>
	{#each data.categories as category, num}
		<div
			in:fade|global={{ num, total: data.categories.length }}
			class="category card bg-darker p-4">
			<div class="flex flex-wrap">
				<a
					class="flex w-full lg:w-3/4 md:w-7/12 light-text no-underline"
					href="/forum/{category.name.toLowerCase()}">
					<div class="w-3/4">
						<h2>
							{category.name}
						</h2>
						{category.description}
					</div>
					<h3 class="w-1/4">
						{category.postCount} post{category.postCount == 1
							? ""
							: "s"}
					</h3>
				</a>
				<div class="w-full lg:w-1/4 md:w-5/12">
					{#if category.latestPost}
						<a
							href="/forum/{category.name.toLowerCase()}/{category
								.latestPost.id}"
							class="light-text no-underline">
							Last post:
							<h3>
								{category.latestPost.title}
							</h3>
						</a>
						<span class="flex gap-2">
							by
							<User
								user={category.latestPost.author}
								full
								thin
								size="1.5rem" />
						</span>
					{/if}
				</div>
			</div>
		</div>
	{/each}
</div>

<style lang="stylus">
	.ctnr
		flex-direction column !important

	.category
		border 1px solid var(--accent2)
		transition all 0.3s ease-out
</style>
